<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hengzhi.dao.ManagerPaperDao">
<resultMap id="UnChangePapers" type="com.hengzhi.dto.ManagerPaper.UnChangePapers">
    <id property="paperId" column="paper_id"/>
    <result property="beginTime" column="begin_time"/>
    <result property="deadLine" column="end_time"/>
    <result property="paperName" column="name"/>
    <result property="score" column="score"/>
    <collection property="unChangeUserList" ofType="com.hengzhi.dto.ManagerPaper.UnChangeUser">
        <id property="paperId" column="paper_id"/>
        <result property="whetherCorrect" column="whether_correct"/>
    </collection>
</resultMap>

    <resultMap id="ChangePapers" type="com.hengzhi.dto.ManagerPaper.ChangePapers">
        <id property="paperId" column="paper_id"/>
        <result property="beginTime" column="begin_time"/>
        <result property="deadLine" column="end_time"/>
        <result property="paperName" column="name"/>
        <result property="totalNumber" column="number"/>
        <collection property="unChangeUserList" ofType="com.hengzhi.dto.ManagerPaper.UnChangeUser">
            <id property="paperId" column="paper_id"/>
            <result property="whetherCorrect" column="whether_correct"/>
        </collection>
    </resultMap>
    <resultMap id="UnFinishPapers" type="com.hengzhi.dto.ManagerPaper.UnFinishPapers">
        <id property="paperId" column="paper_id"/>
        <result property="beginTime" column="begin_time"/>
        <result property="deadLine" column="end_time"/>
        <result property="paperName" column="name"/>
        <result property="code" column="code"/>
        <result property="description" column="description"/>
    </resultMap>
<!--    待改试卷数据-->
    <select id="selectUnChange" resultMap="UnChangePapers">
        select *
        from papers as p
        join user_paper as up
        where p.paper_id = up.paper_id
        and up.whether_correct = 0
    </select>
    <select id="selectUnChangeNumber" resultType="int">
        select count(*)
        from user_paper
        where whether_correct = 0
    </select>

<!--    已改试卷数据-->
    <select id="selectChange" resultMap="ChangePapers">
        select *
        from papers as p
        join user_paper as up
        where p.paper_id = up.paper_id
        and up.whether_correct = 1
    </select>
<!--未考试试卷信息-->
    <select id="selectUnFinish" resultMap="UnFinishPapers">
        select *
        from papers
        where begin_time &lt;&gt; NOW();
    </select>
</mapper>